"""
Module for all custom errors
"""

from warnings import warn


class RequiredEnvVarException(Exception):
    """Raised when a required environment var is not present"""


class UnauthorizedSTSRequest(Exception):
    """Raised when the STS client is unauthorized"""


class PreSignUrlGenerationFail(Exception):
    """Raised when the STS client is unauthorized"""


try:
    import werkzeug.exceptions as werkzeug_exceptions

    warn(
        'wise_security will no longer raise werkzeug exceptions soon, please start catching wise_security.errors',
        DeprecationWarning,
    )

    class DeprecatedWerkzeugException:
        """Base class for all deprecated werkzeug exceptions"""

        def __init__(self, *args, **kwargs):
            """This throws a deprecation warning on initialization."""
            warn(
                'wise_security won\'t raise Werkzeug exceptions soon. '
                'Please, catch wise_security.errors exceptions and raise yours accordingly',
                DeprecationWarning,
                stacklevel=2,
            )
            super().__init__(*args, **kwargs)

    class Unauthorized(DeprecatedWerkzeugException, werkzeug_exceptions.Unauthorized):
        """Raised when the client is unauthorized"""

    class Forbidden(DeprecatedWerkzeugException, werkzeug_exceptions.Forbidden):
        """Raised when the client is forbidden to access the resource"""

except ImportError:

    class Unauthorized(Exception):  # type: ignore[no-redef]
        """Raised when the client is unauthorized"""

    class Forbidden(Exception):  # type: ignore[no-redef]
        """Raised when the client is forbidden to access the resource"""
